# Статусы объектов

## Доступные объекты

* Документ `Расходная накладная`
* Справочник `Договоры контрагентов`
* Справочник `Контрагенты`

## Как создать статус

Статусы объектов -> Контрагенты -> Создать статус.

В элементе указываем название статуса.

Описание полей:

## Раздел Основное

* Наименование - подставляется в название кнопок на форме установки статуса.
* Объект владелец - группа объекта, к которой принадлежит статус. В данном случае это группа Контрагенты.
* Группа владелец - текущая группа статусов. Изначально планировалось реализовать возможность создавать различные группы статусов объектов и делать переходы между ними, но на текущий момент это не реализовано.
* Родитель - группа внутри группы статусов, которой принадлежит статус.
* Описание - здесь можно задать описание статуса. Поле подставляется в карточку контрагента, где отображается статус.
* Цвет - установленный цвет отображается в карточке контрагента.
* Условие отображения. Здесь можно указывать условия отображения статуса на встроенном языке. В поле ввода доступен контекст объекта, которому принадлежит этот статус. Например, я могу указать, что отображать статус `В работе`, если заполнен контрагент в документе расходная накладная таким выражением: 
`ЗначениеЗаполнено(Контрагент)`. И тогда статус будет отображаться в объекте РН только при таком условии.
* Порядок - поле задает порядок статуса
* Идентификатор - служебное поле, характеризующее идентификатор статуса. Не редактируется пользователем.

Менять статусы можно из карточки объектов.
Для документа `Расходная накладная`, справочника `Договоры контрагентов` статус изменить можно по кнопке `Статус` в карточке объекта.
Для справочника `Контрагенты` изменить статус можно по кнопке `Изменить статус`.

## Раздел Роботы (beta)

В роботах можно описать параметры действий. Например, если настроить робота `Отправить сообщение в линию поддержки`, можно задать сообщение по шаблону, указать нужные параметры, которые подставятся во время выполнения робота. А в роботе `Изменить дополнительный параметр` вы можете изменить любой параметр, главное указать его идентификатор и нужное значение.
Таким образом, это дает возможность переопределить логику установки Статусов контрагентов на любую логику.
Роботов, созданных системой, можно увидеть в справочнике `Статусы объектов -> Контрагенты -> Любой статус -> вкладка Роботы`. Вы можете их изменить или удалить вообще и тогда при такой логике статус контрагента будет меняться только в программе.

На текущий момент доступны следующие роботы:

* Отправить сообщение в линию поддержки
* Отправить рассылку в линию поддержки
* Отправить сообщение в группу
* Изменить дополнительный параметр

## Как добавить робота

* Робот добавляется по кнопке Добавить. Выбрав нужного робота в строке откроется его форма.
В доступных полях можно указывать идентификаторы полей объектов. На текущий момент редактор не так развит, и подсказки полей сейчас нет.

Доступные поля для вставки:

```

* Параметры.Контрагент. Из Контрагента можно получать значения его свойств по точке.
* Параметры.ЗапретНаРаботуСКлиентом.ПричинаЗапрета
* Параметры.ЗапретНаРаботуСКлиентом.Комментарий
* Параметры.ЗапретНаРаботуСКлиентом.ОтправлятьСообщениеКлиенту
* Параметры.ЗапретНаРаботуСКлиентом.Отправитель
* Параметры.ЗапретНаРаботуСКлиентом.ЛинияПоддержки

```
Также можно использовать перечисления конфигурации, системные перечисления, предопределенные элементы объектов.

Также рекомендуется заключать вставляемые выражения в квадратные скобки. Пример:
Ответственный по контрагенту: ```[Параметры.Контрагент.Ответственный]```.

На текущий момент можно использовать только методы глобального контекста.
Нельзя использовать условные операторы. Вместо классического Если-Иначе допускается использовать тернарный оператор ```?(<Условие>, <Значение если Истина>, <Значение если Ложь>)```.
Пример:

```

Мы очень рады работать с [
    ?(Параметры.Контрагент.СегментРынка = Перечисления.СК_БюджетХозрасчет.Бюджет,  
    "вашим учреждением",
    "вашей компанией")  
]. Благодарим за обращение. Были рады помочь.

```

## Как работать со статусами

Откроем документ ``Расходная накладная``.
На командной панели документа должна была появиться кнопка ``Статус``

![Статусы на командной панели](https://sorokinltd.github.io/franchisee-manag-doc.github.io/img/statuses-on-form.png)

Если нажать на кнопку, раскроется список статусов из справочника ``Статусы объектов``.

Чтобы изменить статус, нужно нажать на статус. Тогда возле отмеченного статуса отобразится ``зеленая галочка``.
Чтобы подтвердить изменение статуса, нужно записать объект.

Аналогично работает и для договоров.
Для контрагентов принцип изменения статусов немного другой.

На форме контрагента нужно нажать на кнопку ``Изменить статус``.
![Статусы на форме контрагента](https://sorokinltd.github.io/franchisee-manag-doc.github.io/img/status-on-form-customer.png)

Затем откроется форма изменения статуса. Подробнее см. [здесь](https://sorokinltd.github.io/franchisee-manag-doc.github.io/docs/status-customer)

Список доступных статусов на форме изменения статусов у контрагента тоже можно менять.
