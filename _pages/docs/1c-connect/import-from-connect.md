---
layout: default
title: Перенос работ и заявок на обслуживание
grand_parent: Документация
parent: 1С-Коннект
nav_order: 2
permalink: /import-from-connect/
---

# {{ page.title }}

Создание записей в документах `Учет времени` и `Задание на работу` на основе данных из 1С-Коннект.

**Ограничения API при получении данных**

1. При вызове операции в дневное время максимальное значение запрашиваемого периода не может превышать 60 календарных дней.

2. Обновление данных в 1С-Коннект происходит раз в 15 минут, поэтому при переносе работ можно заметить, что работы появляются через некоторое время.

{: .warning }
Для правильной работы необходимо, чтобы фамилия и дата рождения сотрудника в УНФ совпадала с фамилией и датой рождения специалиста в 1С-Коннект.

## Как открыть

`УНФФ С&К -> 1С-Коннект -> Перенос работ и заявок на обслуживание`

## Начало работы

Если у вас не настроена синхронизация с 1С-Коннект, то узнать, как настроить, можно [здесь]({{ site.baseurl }}/one-c-connect/)

## Перенос работ из 1С-Коннект

Механизм импортирует удаленные подключения из 1С-Коннект и создает на их основе записи в документе `Учет времени`.

* Откройте раздел `Работы`.
* Выберите получаемый период.
* Укажите номенклатуру, которая будет подставляться к создаваемым записям. Обычно это может быть услуга: например, оказание услуг по сопровождению.

* Нажмите на `Получить данные`. Таблица заполнится списком подключений к клиентам за выбранный период.

![Импорт работ из 1С-Коннект](../img/import-from-connect.png)

Если комментарий к подключению не был указан в 1С-Коннект, его можно указать в списке.
Если в комментарии первым символом указать `+`, то такая работа считается оплачиваемой, и она попадет в документ `Расходная накладная` или `Заказ покупателя`.

Жирным шрифтом выделелены клиенты, у которых есть абонентский договор.

* Нажмите на `Создать документы`. Создастся документ, в который внесутся работы из списка. Если в указанном периоде будет найден существующий документ, система предложит добавить данные в существующий документ.

![Созданные документы УВ](../img/work-time-document.png)

Проведем документ.

Перейдем в отчет Учет рабочего времени:

![Отчет по работам](../img/work-time-report.png)

Время работ округлилось по заданной тарификации в настройках системы.
Сумма посчиталась по установленным ценам. Для первых двух клиентов договор не определился, и для них цена подставилась по умолчанию.
Для третьего уже взялась цена из пакета часов, который указан в тарифе.

Подробнее об устройстве отчета Учет рабочего времени можно прочитать [здесь]({{ site.baseurl }}/work-time).

Подробнее об ценах в договорах можно прочитать [здесь]({{ site.baseurl }}/contracts/#%D0%BA%D0%B0%D0%BA-%D1%83%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%B8%D1%82%D1%8C-%D1%86%D0%B5%D0%BD%D1%83-%D0%B4%D0%BE%D0%B3%D0%BE%D0%B2%D0%BE%D1%80%D0%B0).

## Перенос заявок на обслуживание из 1С-Коннект

Механизм импортирует завершенные заявки из 1С-Коннект и создает на их основе документы `Задание на работу`. Под завершенными заявками имеются ввиду заявки со статусом `Завершена`.

* Откройте раздел `Заявки на обслуживание`.
* Выберите получаемый период.
* Нажмите на `Получить данные`. Таблица заполнится списком завершенных заявок за выбранный период.

![Импорт заявок из 1С-Коннект](../img/requests-import-from-connect.png)

{: .note }
Чтобы номенклатура заполнялась правильно, необходимо выполнить синхронизацию номенклатуры УНФ с каталогом услуг и видов работ в 1С-Коннект - [подробнее]({{ site.baseurl}}/nomenclature-to-connect)

Все поля заполняются данными из соответствующих полей в 1С-Коннект.
Датой начала заявки считается дата, когда заявка была переведена в статус `Выполняется`, а дата окончания - дата, когда в заявке был установлен статус `Завершена`. 

* Нажмите на `Создать документы`. Создастся документ `Задание на работу`, в который внесутся данные из списка. Каждая строка в списке - это отдельный документ.

![Созданные документы Задание на работу](../img/task-on-work-document.png)

Документ создается сразу в состоянии `Завершено`, т.к. мы загружаем завершенные заявки.

Поле `Трудоемкость` заполнилось значением из поля `Длительность`, которое в 1С-Коннект необязательное и заполняется вручную. В документе поле заполнилось только для информации и в отчете это значение никак не учитывается.

Перейдем в отчет Учет рабочего времени:

![Отчет по работам](../img/work-time-report-with-tasks-on-work.png)

Все перенесенные работы из заявок всегда оплачиваемые. Сумма работ берется из суммы документа `Задание на работу`.
Время выполнения заявки можно увидеть, включив опцию `Время` у отчета УРВ. При создании документов на оплату, это время не учитывается и считается за единицу как штуки.

## Пример работы

* Предположим, что к нам обратился клиент. Для того, чтобы работать с ним, заключим с ним договор.
Пусть в нашем случае это будет договор с категорией `Часы`. Для этого добавим договор в систему.

* Для начала создадим тариф, привязанный к категории `Часы`:

![Тариф Часы](../img/example-tarif.png)

В нем мы добавили пакет часов для того, чтобы устанавливалась цена.

* Установим цену пакета `Базовый`. Перейдем в `Настройки подсистемы -> Пакеты часов`.

![Установка цен пакета](../img/ex-price-package.png)

Сохраним цену.

* Установим тарификацию, чтобы у нас округлялось время по 15 минут. Перейдем в `Настройки подсистемы -> Тарификация`.

![Установка тарификации](../img/ex-tarification.png)

Сохраним тарификацию.

Таким образом, договор будет иметь примерно такой вид:

![Пример карточки договора](../img/ex-contract.png)

* Предположим, специалист поработал с клиентом в 1С-Коннект и загрузил работы в УНФ:

![Загрузка работ](../img/ex-import-from-connect.png)

Мы заполнили поле `Номенклатура` в шапке для того, чтобы эта услуга заполнилась в списке работ. При необходимости в строках можно поменять номенклатуру.

* Нажмем на `Создать документы`, если у нас уже есть документ на этой неделе, добавим работы в существующий документ. Если еще не было документов, то пусть создастся новый документ.

* Проверим, как выглядит отчет `Учет рабочего времени`

![Пример отчета](../img/ex-work-time-report.png)

В отчете подставился наш созданный ранее договор.
Время округлилось по тарификации 15 минут. А цена подставилась из пакета `Базовый`, который мы создали ранее.

Для того, чтобы выставить счет за эти работы, нужно чтобы в комментарии к работе стоял `+`. Заполним комментарий и посмотрим, что изменилось в отчете:

![Пример отчета](../img/paid-work-time.png)

Заполнилась колонка `Часы к оплате` и `Сумма к оплате`. Эти работы и выставятся на оплату.
Создадим расходную накладную на основе этих работ. В данном случае нас интересует только этот контрагент, поэтому поставим в отчете по нему отбор, заполним дату создания документов, и нажмем на кнопку `Создать расходные накладные`:

![Создание документа](../img/ex-create-doc.png)

Получаем такой документ:

![Создание документа](../img/ex-doc-from-report.png)

Проведем документ. После этого документ можно отправить клиенту в 1С-Коннект - [подробнее]({{ site.baseurl }}/send-messages-from-documents)
